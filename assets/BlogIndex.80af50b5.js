import{d as x,u as P,a as $,r as g,o as k,c as e,w as b,v as y,F as p,i as w,b as B,e as C,f as S}from"./index.4367fab1.js";import{U as A,b as D}from"./beautifyDate.0477647a.js";import{u as U,b as s,a as N}from"./useRenderMultiSkeleton.8722b090.js";import{u as R}from"./useIfLoading.8c90111b.js";import{g as T}from"./blog.feda4705.js";import{s as L}from"./scrollToTop.b0913037.js";import"./index.aa191d72.js";import"./KeyCode.38631740.js";import"./SearchOutlined.2390ba86.js";import"./isSymbol.9ea0fba9.js";function j(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!w(i)}var J=x({name:"BlogIndex",props:{},setup(){const i=R(),m=P(),f=$(),c=g([]),d=g(0),t=g(1),a=g(20),o=async l=>{const{data:u,total:h,totalPage:I,page:v}=await T({page:l});return u&&(c.value=u),h&&I&&(d.value=a.value*I),v&&(t.value=v),{blogList:u,totalPage:I,page:v}},r=async()=>{t.value=parseInt(f.query.page)||1,await o(t.value)},n=async l=>{L(),await o(l),await m.push({path:"/",query:{page:l}})};return k(async()=>{L(),await r()}),{blogDataList:c,currentPage:t,allPages:d,pageSize:a,getBlogList:r,onPageChange:n,loading:i}},render(){const i=t=>{const{user:a}=t,{avatar:o,id:r,username:n}=a;return e(p,null,[e("figure",{class:s.avatar},[e(A,{userId:r},{default:()=>[e("img",{class:s.img,src:o,alt:n},null)]}),e("figcaption",{class:s.info},[e(A,{userId:r},j(n)?n:{default:()=>[n]})])])])},m=t=>{const{createdAt:a,description:o,title:r}=t;return e(p,null,[e("h3",{class:s.title},[e("span",{class:s.text},[r]),e("span",{class:s.date},[`${D(a)}`,B(" ")])]),e("p",{class:C([s.description,s.omitText])},[o])])},f=t=>{const{id:a}=t;return e("p",{class:s.detailLink},[e(S("router-link"),{to:`/detail/${a}`},{default:()=>[B("\u8BE6\u7EC6 >>>")]})])},c=t=>{const{updatedAt:a,createdAt:o,id:r,user:n}=t,{id:l,updatedAt:u,createdAt:h}=n;return b(e("article",{class:s.item,key:`${r}${l}${a}${o}${u}${h}`},[i(t),m(t),f(t)]),[[y,!this.loading]])},d=t=>b(e("section",{class:"article-list"},[t.map(a=>e(p,null,[c(a)]))]),[[y,!this.loading]]);return e(p,null,[this.loading&&U(this.loading,"others",()=>{},!0,!0,!0,!1),this.blogDataList&&d(this.blogDataList),N(this.allPages,this.pageSize,this.currentPage,this.onPageChange)])}});export{J as default};
